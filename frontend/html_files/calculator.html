
<!doctype html>
<html lang="fr-fr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="job xp calculator">
        <meta name="author" content="Elisa Desmetz">
        <title>Wakfu job XP calculator</title>
        <!-- Favicon -->
        <!--<link rel="shortcut icon" href="static/img/favicon.ico"> -->

        <!-- JS -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <!-- Bootstrap CSS -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

        <!-- Custom styles for this template -->
        <!--<link href="/static/style.css" rel="stylesheet">-->
    </head>
    <body style="background-color: #313131;">
        <div class="container mt-3">
            <div class="card align-self-center">
                <div class="card-header" style="background-color: ghostwhite;">
                    <h3 class="card-title text-center mb-3">Job XP calculator</h3>
                </div>
                <div class="card-body" style="background-color: ghostwhite;">
                    <form>
                        <div class="form-group row">
                            <div class="col">
                                <label for="lvlActuel" class="form-label" >Niveau Actuel</label>
                                <input class="form-control mb-4" type="number" id="lvlActuel" name="lvlActuel" value="0" min="0"/>    
                            </div>
                            <div class="col">
                                <label for="lvlVise" class="form-label">Niveau &agrave; atteindre</label>
                                <input class="form-control mb-4 col" type="number" id="lvlVise" name="lvlVise" value="1" min="1"/>
                            </div>
                            <div class="col">
                                <label for="xpActuelle" class="form-label">XP actuelle</label>
                                <input class="form-control mb-4 col" type="number" id="xpActuelle" name="xpActuelle" value="0" min="0"/>
                            </div>
                        </div>
                        <div class="row"> 
                            <div class="col-4"> 
                                <button id="calculer" class="btn btn-lg btn-primary btn-dark">Calculer</button>
                            </div>
                            <div id="resultat" class="col">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="card-footer text-right" style="background-color: ghostwhite;">
                    <a href="./" class="btn btn-lg btn-dark btn-secondary">Retour index</a>
                </div>
            </div>
        </div>
    </body>
    <script>
        $('body').on('click','#calculer', function(){
            var actLvl = $('#lvlActuel').val();
            var newLvl = $('#lvlVise').val();
            var xp = $('#xpActuelle').val();
            var res;
            var nextXp = +actLvl * 150 + 75;

            if (+xp >= +nextXp) {
                res = "Valeur de l'exp&eacute;rience actuelle impossible.";
            }
            else if (+actLvl > +newLvl) {
                res = "Niveau actuel sup&eacute;rieur au niveau vis&eacute;.";
            }
            else if (+actLvl == +newLvl) {
                res = "Vous avez d&eacute;j&agrave; atteint le niveau vis&eacute;.";
            }
            else {
                res = "XP &agrave; obtenir : " + xpNeed(+actLvl, +newLvl, +xp);
            }

            $("#resultat").html(res);
            return false;
        });

        function totXp(lvl) {
            return (0.5  * lvl * (lvl - 1) * 150 + lvl * 75);
        }
        
        function xpNeed(oldLvl, newLvl, currentXp) {
            return (totXp(newLvl) - totXp(oldLvl) - currentXp);
        }
    </script>
</html>